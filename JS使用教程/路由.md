# [RabbitMQ tutorial - Routing](https://www.rabbitmq.com/tutorials/tutorial-four-javascript)

## 路由(Routing)

### (using the amqp.node client)

在[上一教程](./发布和订阅.md)中，我们建立了一个简单的日志系统。我们可以向许多接收器广播日志信息。

在本教程中，我们将为其添加一项功能--只订阅部分消息。例如，我们可以只将重要的错误信息发送到日志文件（以节省磁盘空间），同时仍然可以在控制台上打印所有日志信息。

## 绑定(Bindings)

在之前的示例中，我们已经创建了绑定。您可能还记得以下代码:

```javascript
channel.bindQueue(q.queue, exchange, "");
```

绑定是交换器(exchange)和队列之间的关系。这可以简单地理解为:队列对来自交换器(exchange)的消息感兴趣。

绑定可以接受一个额外的绑定键参数(上面代码中的空字符串)。下面是我们如何创建一个带有 key 的绑定示例:

```javascript
channel.bindQueue(queue_name, exchange_name, "black");
```

绑定密钥(binding key)的含义取决于交换类型。我们之前使用的扇出(fanout)交换只是忽略了它的值。

## 直接交换

上一教程中的日志系统将所有消息广播给所有消费者。我们希望对其进行扩展，以允许根据消息的重要程度过滤消息。例如，我们可能希望将日志消息写入磁盘的脚本只接收关键错误，而不是在警告或信息日志消息上浪费磁盘空间。

我们使用的是`扇出(fanout)`交换，这给不了我们很大的灵活性——它只能进行不需要动脑的广播。

我们将采用`直接(direct)`交换的方式。直接交换背后的路由算法很简单——消息被送到与其`绑定密钥(binding key)`完全匹配的队列中。

为了说明这一点，请思考以下假设:
...待续
